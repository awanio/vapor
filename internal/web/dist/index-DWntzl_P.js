!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const t=new class{constructor(){this.locale="en",this.translations=/* @__PURE__ */new Map,this.listeners=/* @__PURE__ */new Set,this.initPromise=null,this.initialized=!1;const t=localStorage.getItem("locale");if(t&&this.isValidLocale(t))this.locale=t;else{const t=navigator.language.split("-")[0];this.isValidLocale(t)&&(this.locale=t)}}isValidLocale(t){return"en"===t||"id"===t}async loadTranslations(t){if(!this.translations.has(t))try{const e=!1?"/src/locales":"/locales",s=await fetch(`${e}/${t}.json`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const o=await s.json();this.translations.set(t,o),console.log(`Loaded translations for locale ${t}`)}catch(e){console.error(`Failed to load translations for locale ${t}:`,e);try{const e=`/locales/${t}.json`,s=await fetch(e);if(s.ok){const e=await s.json();this.translations.set(t,e),console.log(`Loaded translations for locale ${t} from fallback path`)}}catch(s){console.error(`Fallback also failed for locale ${t}:`,s)}}}async setLocale(t){this.locale!==t&&(await this.loadTranslations(t),this.locale=t,localStorage.setItem("locale",t),this.notifyListeners(),document.documentElement.lang=t)}getLocale(){return this.locale}t(t,e){const s=this.translations.get(this.locale);if(!s)return console.warn(`No translations loaded for locale: ${this.locale}, key: ${t}`),t;const o=t.split(".");let n=s;for(const i of o){if("object"!=typeof n||!(i in n))return console.warn(`Translation key not found: ${t} in locale: ${this.locale}`),t;n=n[i]}return"string"!=typeof n?(console.warn(`Translation value is not a string for key: ${t}, got:`,n),t):e?n.replace(/\{\{(\w+)\}\}/g,(t,s)=>s in e?String(e[s]):t):n}onChange(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notifyListeners(){this.listeners.forEach(t=>t())}async init(){return this.initPromise?this.initPromise:this.initialized?Promise.resolve():(this.initPromise=Promise.all([this.loadTranslations("en"),this.loadTranslations(this.locale)]).then(()=>{this.initialized=!0,console.log("i18n fully initialized with translations")}),this.initPromise)}isInitialized(){return this.initialized}};function e(e,s){return t.t(e,s)}function s(t){const{protocol:e,host:s}=window.location;return"http"===t?`${e}//${s}`:`${"https:"===e?"wss":"ws"}://${s}`}const o={...{API_BASE_URL:s("http"),WS_BASE_URL:s("ws"),API_VERSION:"/api/v1",ENABLE_DEBUG:!1,ENABLE_MOCK_DATA:!1},...window.VAPOR_CONFIG||{}};function n(t){const e=t.startsWith("/")?t:`/${t}`;return`${o.API_BASE_URL}${o.API_VERSION}${e}`}function i(t){const e=t.startsWith("/")?t:`/${t}`;return`${o.WS_BASE_URL}${e}`}class a{constructor(){this.token=null,this.expiresAt=null,this.loadToken()}static getInstance(){return a.instance||(a.instance=new a),a.instance}loadToken(){const t=localStorage.getItem("jwt_token"),e=localStorage.getItem("jwt_expires_at");if(t&&e){const s=parseInt(e,10);s>Date.now()?(this.token=t,this.expiresAt=s):(console.log("[AuthManager] Token expired, clearing"),this.clearToken())}}saveToken(t,e){const s=e<1e10?1e3*e:e;this.token=t,this.expiresAt=s,localStorage.setItem("jwt_token",t),localStorage.setItem("jwt_expires_at",s.toString())}clearToken(){this.token=null,this.expiresAt=null,localStorage.removeItem("jwt_token"),localStorage.removeItem("jwt_expires_at")}async login(t,e){try{const s="password",o=await fetch(n("/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:e,auth_type:s})}),i=await o.json();return!(!o.ok||"success"!==i.status||!i.data)&&(this.saveToken(i.data.token,i.data.expires_at),window.dispatchEvent(new CustomEvent("auth:login")),!0)}catch(s){return console.error("Login error:",s),!1}}logout(){this.clearToken(),window.dispatchEvent(new CustomEvent("auth:logout")),window.location.href="/"}isAuthenticated(){return this.token&&this.expiresAt||this.loadToken(),!!this.token&&!!this.expiresAt&&this.expiresAt>Date.now()}getToken(){return this.token&&this.expiresAt||this.loadToken(),this.isAuthenticated()?this.token:null}getAuthHeaders(){const t=this.getToken();return t?{Authorization:`Bearer ${t}`}:{}}isTokenExpiringSoon(){if(!this.expiresAt)return!0;return this.expiresAt-Date.now()<3e5}getWebSocketUrl(t){return i(t)}}const r=a.getInstance(),l=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,AuthManager:a,auth:r},Symbol.toStringTag,{value:"Module"}));class c{constructor(){this.currentTheme="dark",this.STORAGE_KEY="vapor-theme";const t=localStorage.getItem(this.STORAGE_KEY);this.currentTheme=t||"dark",this.applyTheme(this.currentTheme)}static getInstance(){return c.instance||(c.instance=new c),c.instance}getTheme(){return this.currentTheme}setTheme(t){this.currentTheme=t,this.applyTheme(t),localStorage.setItem(this.STORAGE_KEY,t),window.dispatchEvent(new CustomEvent("theme-changed",{detail:{theme:t}}))}toggleTheme(){const t="dark"===this.currentTheme?"light":"dark";this.setTheme(t)}applyTheme(t){const e=document.documentElement;"light"===t?(e.classList.add("light"),e.classList.remove("dark")):(e.classList.add("dark"),e.classList.remove("light"))}}const h=c.getInstance();h.getTheme(),r.isAuthenticated(),t.init().then(()=>{console.log("i18n initialized, loading app..."),import("./app-root-DDtyrZfB.js").then(t=>t.x),console.log("Vapor Web UI initialized")}).catch(t=>{console.error("Failed to initialize i18n:",t)});export{i as a,r as b,e as c,l as d,n as g,t as i,h as t};
