!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const t=new class{constructor(){this.locale="en",this.translations=/* @__PURE__ */new Map,this.listeners=/* @__PURE__ */new Set,this.initPromise=null,this.initialized=!1;const t=localStorage.getItem("locale");if(t&&this.isValidLocale(t))this.locale=t;else{const t=navigator.language.split("-")[0];this.isValidLocale(t)&&(this.locale=t)}}isValidLocale(t){return"en"===t||"id"===t}async loadTranslations(t){if(!this.translations.has(t))try{const e=!1?"/src/locales":"/locales",n=await fetch(`${e}/${t}.json`);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.json();this.translations.set(t,o),console.log(`Loaded translations for locale ${t}`)}catch(e){console.error(`Failed to load translations for locale ${t}:`,e);try{const e=`/locales/${t}.json`,n=await fetch(e);if(n.ok){const e=await n.json();this.translations.set(t,e),console.log(`Loaded translations for locale ${t} from fallback path`)}}catch(n){console.error(`Fallback also failed for locale ${t}:`,n)}}}async setLocale(t){this.locale!==t&&(await this.loadTranslations(t),this.locale=t,localStorage.setItem("locale",t),this.notifyListeners(),document.documentElement.lang=t)}getLocale(){return this.locale}t(t,e){const n=this.translations.get(this.locale);if(!n)return console.warn(`No translations loaded for locale: ${this.locale}, key: ${t}`),t;const o=t.split(".");let s=n;for(const i of o){if("object"!=typeof s||!(i in s))return console.warn(`Translation key not found: ${t} in locale: ${this.locale}`),t;s=s[i]}return"string"!=typeof s?(console.warn(`Translation value is not a string for key: ${t}, got:`,s),t):e?s.replace(/\{\{(\w+)\}\}/g,(t,n)=>n in e?String(e[n]):t):s}onChange(t){return this.listeners.add(t),()=>this.listeners.delete(t)}notifyListeners(){this.listeners.forEach(t=>t())}async init(){return this.initPromise?this.initPromise:this.initialized?Promise.resolve():(this.initPromise=Promise.all([this.loadTranslations("en"),this.loadTranslations(this.locale)]).then(()=>{this.initialized=!0,console.log("i18n fully initialized with translations")}),this.initPromise)}isInitialized(){return this.initialized}};function e(e,n){return t.t(e,n)}const n={...{API_BASE_URL:"https://103.179.254.248:7770",WS_BASE_URL:"wss://103.179.254.248:7770",API_VERSION:"/api/v1",ENABLE_DEBUG:!0,ENABLE_MOCK_DATA:!1},...window.VAPOR_CONFIG||{}};function o(t){const e=t.startsWith("/")?t:`/${t}`;return`${n.API_BASE_URL}${n.API_VERSION}${e}`}function s(t){const e=t.startsWith("/")?t:`/${t}`;return`${n.WS_BASE_URL}${e}`}class i{constructor(){this.token=null,this.expiresAt=null,this.loadToken()}static getInstance(){return i.instance||(i.instance=new i),i.instance}loadToken(){const t=localStorage.getItem("jwt_token"),e=localStorage.getItem("jwt_expires_at");if(t&&e){const n=parseInt(e,10);n>Date.now()?(this.token=t,this.expiresAt=n):(console.log("[AuthManager] Token expired, clearing"),this.clearToken())}}saveToken(t,e){const n=e<1e10?1e3*e:e;this.token=t,this.expiresAt=n,localStorage.setItem("jwt_token",t),localStorage.setItem("jwt_expires_at",n.toString())}clearToken(){this.token=null,this.expiresAt=null,localStorage.removeItem("jwt_token"),localStorage.removeItem("jwt_expires_at")}async login(t,e){try{const n="password",s=await fetch(o("/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:e,auth_type:n})}),i=await s.json();return!(!s.ok||"success"!==i.status||!i.data)&&(this.saveToken(i.data.token,i.data.expires_at),window.dispatchEvent(new CustomEvent("auth:login")),!0)}catch(n){return console.error("Login error:",n),!1}}logout(){this.clearToken(),window.dispatchEvent(new CustomEvent("auth:logout")),window.location.href="/"}isAuthenticated(){return this.token&&this.expiresAt||this.loadToken(),!!this.token&&!!this.expiresAt&&this.expiresAt>Date.now()}getToken(){return this.token&&this.expiresAt||this.loadToken(),this.isAuthenticated()?this.token:null}getAuthHeaders(){const t=this.getToken();return t?{Authorization:`Bearer ${t}`}:{}}isTokenExpiringSoon(){if(!this.expiresAt)return!0;return this.expiresAt-Date.now()<3e5}getWebSocketUrl(t){return s(t)}}const a=i.getInstance(),r=/* @__PURE__ */Object.freeze(/* @__PURE__ */Object.defineProperty({__proto__:null,AuthManager:i,auth:a},Symbol.toStringTag,{value:"Module"}));class l{constructor(){this.currentTheme="dark",this.STORAGE_KEY="vapor-theme";const t=localStorage.getItem(this.STORAGE_KEY);this.currentTheme=t||"dark",this.applyTheme(this.currentTheme)}static getInstance(){return l.instance||(l.instance=new l),l.instance}getTheme(){return this.currentTheme}setTheme(t){this.currentTheme=t,this.applyTheme(t),localStorage.setItem(this.STORAGE_KEY,t),window.dispatchEvent(new CustomEvent("theme-changed",{detail:{theme:t}}))}toggleTheme(){const t="dark"===this.currentTheme?"light":"dark";this.setTheme(t)}applyTheme(t){const e=document.documentElement;"light"===t?(e.classList.add("light"),e.classList.remove("dark")):(e.classList.add("dark"),e.classList.remove("light"))}}const c=l.getInstance(),h=void 0!==import.meta&&!0,u={},d=[];function g(t,e=1){h&&(u[t]=(u[t]??0)+e)}function p(t){return h?(d.push(t),()=>{const e=d.indexOf(t);e>=0&&d.splice(e,1)}):()=>{}}if(h&&"undefined"!=typeof window){const t=Date.now(),e=3e4;window.setInterval(()=>{const e=Math.round((Date.now()-t)/1e3),n={...u},o=function(){const t={};for(const n of d)try{Object.assign(t,n())}catch(e){console.warn("[PerfDebug] gauge error",e)}return t}(),s=function(){try{const t="undefined"!=typeof performance?performance:null;if(t&&t.memory){const{usedJSHeapSize:e,totalJSHeapSize:n,jsHeapSizeLimit:o}=t.memory;return{usedJSHeapSize:e,totalJSHeapSize:n,jsHeapSizeLimit:o}}}catch{}}();console.log("[PerfDebug]",{ts:/* @__PURE__ */(new Date).toISOString(),elapsedSec:e,counters:n,gauges:o,memory:s})},e)}c.getTheme(),a.isAuthenticated(),t.init().then(()=>{console.log("i18n initialized, loading app..."),import("./app-root-DS5PKxYf.js").then(t=>t.x),console.log("Vapor Web UI initialized")}).catch(t=>{console.error("Failed to initialize i18n:",t)});export{s as a,a as b,e as c,r as d,o as g,t as i,g as p,p as r,c as t};
