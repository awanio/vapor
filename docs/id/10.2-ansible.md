# Integrasi Ansible

Vapor menyediakan integrasi Ansible yang seamless untuk automasi infrastruktur, manajemen konfigurasi, dan orkestrasi. Jalankan playbook, kelola inventory, dan lacak riwayat eksekusi melalui antarmuka yang intuitif.

## Prasyarat

* Ansible 2.9+ terinstal pada sistem
* Akses SSH ke managed node
* ansible.cfg yang dikonfigurasi dengan benar
* Python pada managed node

## Navigasi ke Ansible

1. Dari menu utama, klik **Ansible**
2. Tiga tab utama tersedia:
   * Playbooks & Templates
   * Inventory
   * Executions

## Manajemen Playbook

Tab **Playbooks** mengelola playbook dan template Ansible.

### Library Playbook

Lihat semua playbook yang tersedia:
* Nama dan path playbook
* Deskripsi (dari metadata)
* Waktu modifikasi terakhir
* Jumlah eksekusi
* Tag yang tersedia
* Variable yang diperlukan

### Menjalankan Playbook

#### Quick Execute

1. Klik **Run** pada playbook
2. Pilih inventory atau host
3. Klik **Execute**

#### Advanced Execute

1. Klik **Advanced Run**
2. Konfigurasi eksekusi:
   * **Inventory**: Pilih file inventory
   * **Limit**: Host/grup spesifik
   * **Tags**: Jalankan tag tertentu saja
   * **Variables**: Pasangan key-value atau JSON
   * **Check Mode**: Dry run tanpa perubahan
   * **Verbose Level**: Level output debug

## Manajemen Inventory

Tab **Inventory** mengelola Ansible inventory.

### Tipe Inventory

#### Static Inventory
Format INI atau YAML tradisional

#### Dynamic Inventory
Generate inventory dari sumber:
* Cloud Provider: AWS, Azure, GCP
* Virtualisasi: VMware, Libvirt
* Container: Docker, Kubernetes
* CMDB: ServiceNow, NetBox

### Membuat Inventory

1. Klik **Create Inventory**
2. Pilih tipe:
   * **Manual**: Masukkan host manual
   * **Import**: Upload file inventory
   * **Dynamic**: Konfigurasi sumber
3. Tambahkan host dan grup
4. Atur variable
5. Klik **Save**

## Riwayat Eksekusi

Tab **Executions** menampilkan semua Ansible run.

### Daftar Eksekusi

Setiap eksekusi menampilkan:
* ID Eksekusi
* Nama playbook
* Waktu mulai dan durasi
* Status (Running, Success, Failed)
* User yang menginisiasi
* Host yang terpengaruh

### Detail Eksekusi

Klik pada eksekusi untuk melihat:
* Total host target
* Berhasil/gagal/unreachable
* Task yang dijalankan
* Perubahan yang dibuat
* Waktu eksekusi

## Ad-hoc Command

Jalankan perintah cepat tanpa playbook:

1. Klik **Ad-hoc Command**
2. Pilih:
   * Target host/grup
   * Module untuk digunakan
   * Argumen module
   * Opsi eksekusi
3. Klik **Run**

Penggunaan ad-hoc umum:
* Test konektivitas ping
* Gather facts
* Copy file
* Restart service
* Install package
* Periksa disk space

## Praktik Terbaik

### Desain Playbook
1. **Idempotency**: Pastikan playbook dapat dijalankan berkali-kali
2. **Error Handling**: Gunakan block dan rescue
3. **Penggunaan Variable**: Parameterisasi untuk fleksibilitas
4. **Role-Based**: Organisir ke dalam role yang dapat digunakan kembali
5. **Dokumentasi**: Beri komentar pada task kompleks

### Keamanan
1. **Penggunaan Vault**: Enkripsi data sensitif
2. **Manajemen Key**: Gunakan SSH key, bukan password
3. **Least Privilege**: Minimalkan penggunaan sudo
4. **Audit Trail**: Log semua eksekusi
5. **Validasi Input**: Sanitasi input user

## Pemecahan Masalah

### Masalah Koneksi
* Verifikasi konektivitas SSH
* Periksa SSH key/password
* Pastikan Python terinstal di target
* Verifikasi ansible_user benar
* Periksa aturan firewall

### Kegagalan Playbook
* Review pesan error
* Periksa syntax dengan ansible-playbook --syntax-check
* Verifikasi variable terdefinisi
* Test dengan verbosity lebih tinggi (-vvv)
* Periksa dokumentasi module
