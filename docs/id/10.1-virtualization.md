# Manajemen Virtualisasi

Vapor menyediakan manajemen mesin virtual yang komprehensif menggunakan KVM/Libvirt. Anda dapat membuat, mengelola, dan memantau VM dengan fitur lanjutan seperti PCI passthrough, snapshot, dan live migration.

## Prasyarat

* Modul kernel KVM dimuat
* Daemon Libvirt berjalan
* QEMU/KVM terinstal
* Izin yang sesuai untuk manajemen VM
* Dukungan virtualisasi CPU yang memadai (Intel VT-x atau AMD-V)

## Navigasi ke Virtualisasi

1. Dari menu utama, klik **Virtualization**
2. Tiga bagian utama tersedia:
   * Virtual Machines
   * Storage Pools
   * Networks

## Mesin Virtual

Tab **VMs** menampilkan semua mesin virtual pada sistem.

### Membuat Mesin Virtual

#### Quick Create

1. Klik **Create VM**
2. Konfigurasi dasar:
   * **Name**: Identifier VM
   * **vCPUs**: Jumlah CPU virtual
   * **Memory**: Alokasi RAM (MB)
   * **OS Type**: Linux, Windows, dll
   * **OS Variant**: Distribusi/versi spesifik
3. Konfigurasi storage:
   * **Storage Pool**: Lokasi disk
   * **Disk Size**: Ukuran dalam GB
   * **Boot ISO**: Media instalasi
4. Klik **Create**

### Mengelola VM

#### Operasi Power

* **Start**: Boot VM
* **Shutdown**: Shutdown dengan aman via ACPI
* **Force Off**: Matikan segera
* **Reboot**: Restart VM
* **Reset**: Hard reset
* **Pause**: Tangguhkan eksekusi VM
* **Resume**: Lanjutkan dari pause

#### Akses Console

1. Klik tombol **Console**
2. Pilih tipe koneksi:
   * **VNC Console**: Viewer VNC berbasis web
   * **SPICE Console**: Fitur enhanced
   * **Serial Console**: Akses berbasis teks

#### Snapshot

##### Membuat Snapshot

1. Klik **Snapshots** di detail VM
2. Klik **Create Snapshot**
3. Masukkan:
   * **Name**: Identifier snapshot
   * **Description**: Catatan opsional
   * **Memory State**: Sertakan konten RAM
4. Klik **Create**

##### Mengelola Snapshot

* **Revert**: Restore VM ke state snapshot
* **Delete**: Hapus snapshot
* **Clone**: Buat VM baru dari snapshot

## Storage Pool

Kelola lokasi storage untuk disk VM.

### Tipe Storage Pool

* **Directory**: Direktori filesystem
* **LVM**: Logical Volume Manager
* **NFS**: Network File System
* **iSCSI**: Network block storage
* **Ceph RBD**: Distributed storage
* **GlusterFS**: Distributed filesystem

### Membuat Storage Pool

1. Klik **Create Pool**
2. Pilih tipe dan konfigurasi:
   * **Directory**: Path di filesystem
   * **NFS**: Server dan export path
   * **iSCSI**: Target dan initiator
3. Atur permissions dan ownership
4. Klik **Create**

## Virtual Network

Konfigurasi networking untuk VM.

### Tipe Network

* **NAT**: Network address translation
* **Bridge**: Direct network bridge
* **Isolated**: Tanpa konektivitas eksternal
* **Routed**: Layer 3 routing
* **Open vSwitch**: SDN networking

### Membuat Network

1. Klik **Create Network**
2. Konfigurasi:
   * **Name**: Network identifier
   * **Mode**: NAT, Bridge, dll
   * **Bridge Name**: Nama Linux bridge
   * **IP Configuration**: Pengaturan DHCP
   * **DNS**: Pengaturan forwarder
3. Klik **Create**

## Template

Buat konfigurasi VM yang dapat digunakan kembali.

### Membuat Template

1. Konfigurasi VM sesuai keinginan
2. Klik **Convert to Template**
3. Template disimpan untuk digunakan kembali

### Menggunakan Template

1. Klik **Create from Template**
2. Pilih template
3. Kustomisasi sesuai kebutuhan:
   * Ubah nama
   * Sesuaikan resource
   * Modifikasi pengaturan network
4. Klik **Create**

## Monitoring dan Metrik

### Monitoring Real-time

Lihat metrik langsung:
* Penggunaan CPU per core
* Utilisasi memory
* Rate I/O disk
* Throughput network
* Statistik block device

## Praktik Terbaik

1. **Perencanaan Resource**: Jangan overcommit CPU/memory
2. **Performa Storage**: Gunakan virtio untuk performa terbaik
3. **Optimasi Network**: Gunakan virtio-net jika memungkinkan
4. **Strategi Backup**: Snapshot dan backup reguler
5. **Keamanan**: Aktifkan SELinux/AppArmor untuk VM
6. **Monitoring**: Pantau tren penggunaan resource
7. **Update**: Jaga guest tools tetap update

## Pemecahan Masalah

### VM Tidak Mau Start

* Periksa log libvirt: `/var/log/libvirt/qemu/`
* Verifikasi resource tersedia
* Periksa storage pool aktif
* Pastikan network dimulai
* Verifikasi permissions

### Performa Buruk

* Aktifkan virtio driver
* Periksa CPU pinning
* Verifikasi konfigurasi huge pages
* Monitor penggunaan resource host
* Periksa pengaturan disk cache

### Masalah Network

* Verifikasi network aktif
* Periksa aturan firewall
* Pastikan konfigurasi bridge
* Test dengan tipe network berbeda
* Periksa status server DHCP
