post:
  summary: Clone a virtual machine
  description: |
    Clone an existing virtual machine to a new VM.

    Notes:
    - Only full clones are currently supported.
    - Snapshot cloning is not supported.
  tags:
    - Virtualization Compute
  security:
    - bearerAuth: []
  parameters:
    - name: id
      in: path
      required: true
      description: Source VM name or UUID
      schema:
        type: string
        example: web-server-01
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          required:
            - name
          properties:
            name:
              type: string
              description: Name of the new cloned VM
              example: web-server-01-clone
            full_clone:
              type: boolean
              description: Whether to create a full clone instead of a linked clone
              default: true
            snapshots:
              type: boolean
              description: Whether to clone snapshots as well (currently not supported)
              default: false
            storage_pool:
              type: string
              description: Optional target storage pool for the cloned disks
              example: fast-ssd
        examples:
          simple:
            summary: Simple full clone
            value:
              name: web-server-01-clone
          different_pool:
            summary: Full clone to a different pool
            value:
              name: web-server-01-backup
              full_clone: true
              storage_pool: backup-pool
  responses:
    '201':
      description: Virtual machine cloned successfully
      content:
        application/json:
          schema:
            $ref: ../components/schemas/VMDirectResponse.yaml
    '400':
      $ref: ../components/responses/BadRequest.yaml
    '404':
      description: Source VM not found
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ErrorResponse.yaml
    '409':
      description: Conflict - VM with target name already exists
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ErrorResponse.yaml
    '500':
      $ref: ../components/responses/InternalError.yaml
