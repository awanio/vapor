post:
  summary: Clone a virtual machine
  description: |
    Clone an existing virtual machine to a new VM.
    The clone operation is synchronous and returns the cloned VM when complete.
  tags:
    - Virtualization Compute
  security:
    - bearerAuth: []
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          required:
            - source_vm
            - name
          properties:
            source_vm:
              type: string
              description: Source VM name or UUID
              example: web-server-01
            name:
              type: string
              description: Name of the new cloned VM
              example: web-server-01-clone
            full_clone:
              type: boolean
              description: Whether to create a full clone instead of a linked clone
              default: true
            snapshots:
              type: boolean
              description: Whether to clone snapshots as well
              default: false
            storage_pool:
              type: string
              description: Optional target storage pool for the cloned disks
              example: fast-ssd
        examples:
          simple:
            summary: Simple full clone
            value:
              source_vm: web-server-01
              name: web-server-01-clone
          with_snapshots:
            summary: Full clone including snapshots to a different pool
            value:
              source_vm: web-server-01
              name: web-server-01-backup
              full_clone: true
              snapshots: true
              storage_pool: backup-pool
  responses:
    '201':
      description: Virtual machine cloned successfully
      content:
        application/json:
          schema:
            $ref: ../components/schemas/VM.yaml
    '400':
      description: Invalid clone request
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
    '500':
      description: Failed to clone virtual machine
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
