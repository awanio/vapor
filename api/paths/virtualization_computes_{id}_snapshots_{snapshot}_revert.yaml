post:
  summary: Revert to snapshot
  description: |
    Revert a virtual machine to a previous snapshot state.

    **Warning:** This operation will:
    - Discard all changes made since the snapshot was taken
    - Restore the VM to the exact state when the snapshot was created
    - Cannot be undone without another snapshot

    **Revert Behavior:**
    By default (flags=1), running VMs will stay running after revert. This is a live revert
    that only works for disk-only snapshots. If the snapshot includes memory state,
    libvirt must restore that memory, which effectively restarts the VM.

    You can control the revert behavior using the `flags` parameter in the request body.
  tags:
    - Virtualization Compute
  security:
    - bearerAuth: []
  parameters:
    - name: id
      in: path
      required: true
      schema:
        type: string
      description: VM name or UUID
    - name: snapshot
      in: path
      required: true
      schema:
        type: string
      description: Snapshot name to revert to
  requestBody:
    description: Optional revert configuration
    required: false
    content:
      application/json:
        schema:
          $ref: ../components/schemas/VMSnapshotRevertRequest.yaml
        examples:
          default:
            summary: Default - Keep running VMs running
            value:
              flags: 1
          force_stop:
            summary: Default libvirt behavior (may restart VM)
            value:
              flags: 0
          paused:
            summary: Leave VM paused after revert
            value:
              flags: 2
  responses:
    '200':
      description: VM reverted to snapshot successfully
      content:
        application/json:
          schema:
            $ref: ../components/schemas/VMSnapshotRevertResponse.yaml
    '404':
      $ref: ../components/responses/NotFound.yaml
    '409':
      description: Conflict - VM is in a state that prevents reverting
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ErrorResponse.yaml
    '500':
      $ref: ../components/responses/InternalError.yaml
