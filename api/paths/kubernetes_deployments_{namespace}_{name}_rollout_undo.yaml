patch:
  summary: Rollback deployment to previous revision
  description: |
    Rollback a deployment to its previous revision.
    
    This operation retrieves the previous revision from the deployment's 
    ReplicaSets and updates the deployment to use the pod template from 
    that previous revision. The rollback triggers a rolling update to 
    replace current pods with pods from the previous configuration.
    
    This is equivalent to running:
    ```bash
    kubectl rollout undo deployment/{name} -n {namespace}
    ```
    
    **Note:** This operation requires at least one previous revision to exist.
    If the deployment has never been updated, the rollback will fail.
  tags:
    - Kubernetes
  security:
    - bearerAuth: []
  parameters:
    - name: namespace
      in: path
      required: true
      description: Deployment namespace
      schema:
        type: string
      example: default
    - name: name
      in: path
      required: true
      description: Deployment name
      schema:
        type: string
      example: nginx-deployment
  responses:
    '200':
      description: Deployment rolled back successfully
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: true
              message:
                type: string
                example: "Deployment default/nginx-deployment has been rolled back to revision 2"
              deployment:
                $ref: ../components/schemas/DeploymentDetail.yaml
    '400':
      description: No previous revision available
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ErrorResponse.yaml
          example:
            success: false
            error:
              code: "BAD_REQUEST"
              message: "No previous revision available"
              details: "The deployment has no previous revision to rollback to"
    '401':
      $ref: ../components/responses/UnauthorizedError.yaml
    '404':
      description: Deployment not found
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ErrorResponse.yaml
    '500':
      description: Failed to rollback deployment
      content:
        application/json:
          schema:
            $ref: ../components/schemas/ErrorResponse.yaml
    '503':
      $ref: ../components/responses/KubernetesNotInstalledError.yaml
